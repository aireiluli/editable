/*! editable - v1.0 - 2013-10-16 2:13:24 PM
* Copyright (c) 2013 yuli; Licensed  */
KISSY.add("gallery/editable/1.0/index",function(a,b,c){function d(b,c){var d=this,f=a.merge(e,c);b=a.all(b),b.length?a.each(b,function(a){d._init(a,f)}):d._init(b,f)}var e={editEvent:"click",submitEvent:"blur",type:"text",editClass:""},f={},g="ks-editable-cache";return a.augment(d,{_init:function(d,e){if(d){d=a.one(d);var h,i=this;d.attr(g,a.guid()),c.on(d,e.editEvent||"click",function(){f[d.attr(g)]?h=f[d.attr(g)]:(e.editTarget?(h=a.all(e.editTarget),e.editClass&&b.addClass(h,e.editClass)):h="textarea"==e.type?b.create('<textarea class="'+e.editClass+'"></textarea'):b.create('<input type="'+e.type+'" class="'+e.editClass+'" />'),f[d.attr(g)]=h,b.insertAfter(h,d),e.editTarget?i.submit=function(a){d.html(a).show(),b.hide(h),i.fire("afterSubmit",{newValue:a})}:c.on(h,e.submitEvent||"blur",function(){d.html(b.val(h)).show(),b.hide(h),i.fire("afterSubmit",{newValue:b.val(h)})}),i.fire("targetReady",{editTarget:h,srcNode:d})),b.hide(d),i.fire("beforeEdit",{oldValue:d.html(),srcNode:d}),e.editTarget?b.show(h):(b.val(h,b.html(d)),b.show(h),h.focus())})}}}),a.augment(d,a.EventTarget),d},{requires:["dom","event"]});